<template>
  <GlobalPageHeader>
    <svg width="1106" height="111" viewBox="0 0 1106 111" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M16.3006 94.9581C5.43354 84.285 0 71.1539 0 55.5C0 39.9108 5.43354 26.7797 16.3006 16.042C27.1677 5.36888 40.6222 0 56.6641 0C72.706 0 86.1605 5.36888 97.0276 16.042C107.895 26.715 113.328 39.8462 113.328 55.5C113.328 71.0892 107.895 84.2203 97.0276 94.9581C86.1605 105.631 72.706 111 56.6641 111C40.6222 110.935 27.1677 105.631 16.3006 94.9581ZM32.5366 30.4021C26.0034 37.1941 22.7691 45.5385 22.7691 55.5C22.7691 65.4615 26.0034 73.8059 32.5366 80.5979C39.0698 87.3899 47.0907 90.7535 56.6641 90.7535C66.3022 90.7535 74.3878 87.3899 80.8563 80.5979C87.3248 73.8059 90.5591 65.4615 90.5591 55.5C90.5591 45.5385 87.3248 37.1941 80.8563 30.4021C74.3878 23.6101 66.3022 20.2465 56.6641 20.2465C47.0907 20.2465 39.0698 23.6101 32.5366 30.4021Z" fill="#0000FF"/>
      <path d="M148.915 109.324H126.922V1.55859H172.525C184.298 1.55859 193.871 4.92223 201.18 11.7142C208.49 18.5062 212.112 27.1093 212.112 37.5883C212.112 48.0674 208.49 56.6058 201.245 63.2037C194 69.8016 184.427 73.1653 172.525 73.1653H148.979V109.324H148.915ZM148.915 21.0936V53.5656H172.46C177.506 53.5656 181.516 52.0779 184.621 49.0376C187.726 45.9974 189.214 42.1163 189.214 37.3943C189.214 32.6723 187.661 28.7911 184.621 25.6862C181.516 22.5813 177.506 21.0936 172.46 21.0936H148.915Z" fill="#0000FF"/>
      <path d="M294.004 109.324H222.203V1.55859H294.004V21.0936H244.261V45.7387H292.451V65.1443H244.261V89.7894H294.004V109.324Z" fill="#0000FF"/>
      <path d="M383.138 104.602V1.55859H405.131V109.389H362.309L330.807 6.28063V109.324H308.814V1.55859H351.507L383.138 104.602Z" fill="#0000FF"/>
      <path d="M421.076 81.5587L432.815 79.1195C434.238 92.9418 442.674 99.8529 458.122 99.8529C466.355 99.8529 473.113 97.9219 478.398 94.0598C483.683 90.1976 486.326 85.4208 486.326 79.7293C486.326 75.1558 484.496 71.3953 480.837 68.4479C477.28 65.3989 472.91 63.0105 467.727 61.2827C462.645 59.4533 457.512 57.5222 452.329 55.4895C447.146 53.4568 442.725 50.5094 439.066 46.6473C435.509 42.6836 433.73 37.7543 433.73 31.8595C433.73 23.0173 437.49 15.6488 445.011 9.75406C452.532 3.75763 461.781 0.759413 472.758 0.759413C482.819 0.759413 490.747 3.40191 496.54 8.68689C502.333 13.8702 505.89 20.883 507.212 29.7252L495.473 32.1644C494.558 25.4566 492.068 20.324 488.003 16.7668C484.039 13.108 478.703 11.2786 471.995 11.2786C464.576 11.2786 458.427 13.108 453.549 16.7668C448.67 20.4257 446.231 24.8976 446.231 30.1826C446.231 34.5528 448.01 38.1609 451.567 41.0066C455.226 43.8524 459.596 46.19 464.678 48.0194C469.861 49.7472 475.044 51.6274 480.228 53.6601C485.411 55.6928 489.781 58.7926 493.338 62.9596C496.997 67.025 498.827 72.1067 498.827 78.2048C498.827 87.6568 494.863 95.4318 486.936 101.53C479.008 107.526 469.2 110.525 457.512 110.525C446.841 110.525 438.354 107.984 432.053 102.902C425.853 97.7186 422.194 90.6042 421.076 81.5587ZM575.262 109H509.708L532.423 2.28393H597.977L595.691 13.108H542.028L533.948 50.3062H586.239L583.952 60.9778H531.661L523.886 98.1759H577.549L575.262 109ZM684.416 27.7433C684.416 37.5002 680.961 45.7834 674.05 52.5929C667.138 59.4024 658.398 63.2137 647.828 64.0268L670.391 109H657.127L634.717 64.1793H613.679L604.227 109H592.336L615.051 2.28393H654.993C663.835 2.28393 670.95 4.67233 676.336 9.44915C681.723 14.226 684.416 20.324 684.416 27.7433ZM615.965 53.0503H645.541C653.265 53.0503 659.668 50.6619 664.75 45.8851C669.832 41.0066 672.373 35.2643 672.373 28.658C672.373 24.0845 670.746 20.3748 667.494 17.5291C664.242 14.5817 659.77 13.108 654.078 13.108H624.655L615.965 53.0503ZM724.551 95.5843L782.331 2.28393H795.289L728.668 109H715.862L694.671 2.28393H706.715L724.551 95.5843ZM796.578 109H784.686L807.402 2.28393H819.293L796.578 109ZM823.417 66.0087C823.417 48.7308 830.024 33.5365 843.236 20.4257C856.55 7.31483 871.948 0.759413 889.429 0.759413C900.812 0.759413 910.416 3.65599 918.242 9.44915C926.068 15.1407 931.302 22.4584 933.945 31.4022L922.358 35.8233C920.529 28.6072 916.616 22.8141 910.62 18.4438C904.725 13.9719 897.509 11.7359 888.972 11.7359C874.844 11.7359 862.394 17.1734 851.621 28.0482C840.949 38.8215 835.614 51.2717 835.614 65.3989C835.614 75.359 838.815 83.5406 845.218 89.9436C851.621 96.3465 860.006 99.548 870.373 99.548C878.91 99.548 887.091 97.3629 894.917 92.9926C902.743 88.5207 909.095 82.6767 913.974 75.4607L924.645 80.3391C918.75 89.0797 910.975 96.2957 901.32 101.987C891.665 107.679 881.197 110.525 869.915 110.525C856.296 110.525 845.116 106.408 836.376 98.1759C827.737 89.8419 823.417 79.1195 823.417 66.0087ZM999.268 109H933.714L956.429 2.28393H1021.98L1019.7 13.108H966.033L957.954 50.3062H1010.24L1007.96 60.9778H955.667L947.892 98.1759H1001.55L999.268 109ZM1017.93 81.5587L1029.67 79.1195C1031.09 92.9418 1039.53 99.8529 1054.98 99.8529C1063.21 99.8529 1069.97 97.9219 1075.25 94.0598C1080.54 90.1976 1083.18 85.4208 1083.18 79.7293C1083.18 75.1558 1081.35 71.3953 1077.69 68.4479C1074.13 65.3989 1069.76 63.0105 1064.58 61.2827C1059.5 59.4533 1054.37 57.5222 1049.18 55.4895C1044 53.4568 1039.58 50.5094 1035.92 46.6473C1032.36 42.6836 1030.58 37.7543 1030.58 31.8595C1030.58 23.0173 1034.34 15.6488 1041.86 9.75406C1049.39 3.75763 1058.63 0.759413 1069.61 0.759413C1079.67 0.759413 1087.6 3.40191 1093.39 8.68689C1099.19 13.8702 1102.74 20.883 1104.07 29.7252L1092.33 32.1644C1091.41 25.4566 1088.92 20.324 1084.86 16.7668C1080.89 13.108 1075.56 11.2786 1068.85 11.2786C1061.43 11.2786 1055.28 13.108 1050.4 16.7668C1045.52 20.4257 1043.08 24.8976 1043.08 30.1826C1043.08 34.5528 1044.86 38.1609 1048.42 41.0066C1052.08 43.8524 1056.45 46.19 1061.53 48.0194C1066.71 49.7472 1071.9 51.6274 1077.08 53.6601C1082.26 55.6928 1086.63 58.7926 1090.19 62.9596C1093.85 67.025 1095.68 72.1067 1095.68 78.2048C1095.68 87.6568 1091.72 95.4318 1083.79 101.53C1075.86 107.526 1066.05 110.525 1054.37 110.525C1043.69 110.525 1035.21 107.984 1028.91 102.902C1022.71 97.7186 1019.05 90.6042 1017.93 81.5587Z" fill="#0000FF"/>
    </svg>
  </GlobalPageHeader>

  <div class="services page-pd-bottom">
    <div class="services__container container">
      <ServicesHead :title="settings.title" :subtitle="settings.subtitle" :video="settings.video" />
      <ServicesFilter v-if="settings.types" :categories="settings.types" @serviceFilter="filter" :is-active-index="termId" />
      <div class="services__row" v-if="post.categories">
        <ServicesCard
          v-for="category in post.categories"
          :key="category.term_id"
          :name="category.name"
          :description="category.description"
          :posts="category.posts"
        />
      </div>
    </div>
  </div>
  <GlobalFooterButton />
</template>

<script setup lang="ts">
const { result: settings } = await useApi( '/services-settings' );
const termId = ref( 34 );

const { data: post } = await useAsyncData(
    'services',
    () => $fetch(getApiUrl('/services'), {
      params: {
        term_id: termId.value,
      }
    }), {
      watch: [termId],
      transform: (resData) => {
        //resData.data.posts = (page.value === 1 ? resData.data.posts : [...postsList.value, ...resData.data.posts]);

        return resData.data;
      },
    },
);


const filter = async ( term_id: number ) => {
  termId.value = term_id;
}
</script>

<style scoped lang="scss">

</style>